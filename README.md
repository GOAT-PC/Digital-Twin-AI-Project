# 联电整车热管理数字孪生：车端多源时序建模与边缘推理落地

## 🚀 项目简介

本项目专注于联电整车热管理系统的数字孪生应用，通过构建先进的车端多源时序预测模型，实现对车辆热管理状态的实时监控与未来趋势预测。项目覆盖了单制冷、单PTC制热和混合制热三种核心工况，并成功将模型工程化部署，支持数字孪生平台进行实时预测与策略评估。

## ✨ 项目亮点 (STAR 法则)

### S (场景)

客户的数字孪生平台需要对车辆热管理系统进行实时监控与预测。具体需求包括：
- **实时曲线展示**：展示**历史 3 分钟 (180s) + 未来 6 分钟 (360s)** 的热管理系统关键参数曲线。
- **滚动更新**：要求预测曲线**每分钟滚动更新**，以适应车辆运行的动态变化。
- **多工况覆盖**：系统需处理**多工况**运行逻辑，包括单制冷、单PTC制热和混合制热，且存在不同输入特征口径的挑战。

### T (任务)

设计并落地一套高效、鲁棒的车端多源时序模型，以覆盖**单制冷/单PTC制热/混合制热**三类核心工况。在满足严格的工程约束（如可部署、可维护、可解释/可扩展）的前提下，完成从数据处理到模型部署的端到端交付，并与数字孪生平台进行接口联调。

### A (行动)

#### 1. 多源时序数据工程

- **数据清洗与切片流程**：建立了从实测车端数据到模型训练集的自动化清洗与切片流程。该流程包括时间轴对齐、滑窗构造、异常/缺失值处理以及归一化统计，形成了可复现的数据集与验证集，覆盖了【待填】台车、累计【待填】趟次、总计【待填】小时的运行数据。
- **统一特征口径**：统一了输入特征口径（≥【待填】维），并沉淀了详细的数据字典和字段说明，显著降低了前后端与客户侧的接入成本。

#### 2. 时序建模与效果验证

- **多工况建模策略**：
  - **单制冷工况**：采用自回归/序列到序列（Sequence-to-Sequence）模型，实现了稳定的多步预测（180s 历史数据 → 360s 未来预测）。
  - **单制热/混合制热工况**：采用半自回归/直接多步等策略。特别是在混合制热工况中，引入了物理信息神经网络（PINN）或能量守恒类损失函数，以提升模型的可解释性与泛化能力，确保预测结果符合物理规律。
- **离线评估体系**：建立了完善的离线评估体系，针对关键目标（如舱温、总功率、压缩机功率、PTC 功率等）输出 MAE、RMSE 和 R² 等指标，并提供可视化对比报告。核心指标达到 MAE【待填】、RMSE【待填】、R²【待填】。

#### 3. 工程化部署与接口交付

- **模型导出与封装**：将训练好的模型导出为 **TorchScript/ONNX (onnxruntime)** 形式，形成“单文件/可控依赖”的轻量级交付包。在线推理服务按**每分钟更新一次**的频率运行，输出历史数据与预测曲线。
- **统一推理接口**：提供了统一的推理接口与平台进行联调，实现了 `/sample_data`（实时仪表数据）与 `/sample_curve`（180s 实测 + 360s 预测曲线）等接口协议，确保平台端数据消费的稳定性和便捷性。
- **解决工程挑战**：成功处理了真实工程问题，如定位并规避 PyTorch **安全反序列化 (safe_globals/weights_only)** 等兼容风险。制定了“Base → PolishHead → TorchScript 单文件交付”方案，有效降低了客户侧的安全审查压力。

#### 4. 文档与可维护性

- **输出专业文档**：输出了详细的模型说明书、接口文档和部署文档。文档内容涵盖模型结构、输入输出规范、参数配置与当前选值、详细的验证结果、运行环境要求以及复现实验步骤，为后续的二次迭代与项目交接提供了坚实的基础。

### R (结果)

- **功能实现**：成功实现了平台端 **180s 历史 + 360s 预测**的实时展示与 **60s 滚动更新**闭环。所有三工况模型均可按统一接口部署交付，满足客户核心业务需求。
- **模型效果**：关键指标（如舱温/总功率）在验证集上达到 MAE【待填】/RMSE【待填】/R²【待填】；相较于基线模型（如 naive/AR/简单 RNN），性能提升了 **【待填】%**。
- **推理性能**：单次推理耗时 **【待填】ms**（CPU/GPU：【待填】），模型大小 **【待填】MB**，完全满足边缘端资源约束和实时性要求。
- **工程效率**：通过标准化的接口和交付方案，接口联调周期缩短了 **【待填】天 / 【待填】%**。交付包支持一键运行/复现（脚本/EXE/容器化【待填】），极大提升了工程效率和可维护性。

## 🛠️ 技术栈

- **编程语言**: Python
- **深度学习框架**: PyTorch
- **模型部署**: TorchScript, ONNX (onnxruntime), Flask
- **数据处理**: Pandas, NumPy
- **版本控制**: Git, GitHub

---
